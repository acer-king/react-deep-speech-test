(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{36:function(e,t,n){e.exports=n(57)},41:function(e,t,n){},42:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=function(e){return e&&e.__esModule?e.default:e},r=function(){function e(e,t){for(var n in t){var a=t[n];a.configurable=!0,a.value&&(a.writable=!0)}Object.defineProperties(e,t)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o=a(n(46)),c=a(n(49)),s=function(){function e(){var t=this,n=void 0===(arguments.length<=0?void 0:arguments[0])?{}:arguments.length<=0?void 0:arguments[0];i(this,e),this.format={floatingPoint:!!n.floatingPoint,bitDepth:0|n.bitDepth||16},this._worker=new o(c,c.self),this._worker.onmessage=function(e){var n=e.data,a=t._callbacks[n.callbackId];a&&("encoded"===n.type?a.resolve(n.buffer):a.reject(new Error(n.message))),t._callbacks[n.callbackId]=null},this._callbacks=[]}return r(e,{canProcess:{value:function(t){return e.canProcess(t)}},encode:{value:function(e,t){var n=this;return null!=t&&"object"===typeof t||(t=this.format),new Promise((function(a,r){var i=n._callbacks.length;n._callbacks.push({resolve:a,reject:r});var o=e.channelData.length,c=e.channelData[0].length,s=e.sampleRate,u=e.channelData.map((function(e){return e.buffer}));e={numberOfChannels:o,length:c,sampleRate:s,buffers:u},n._worker.postMessage({type:"encode",audioData:e,format:t,callbackId:i},e.buffers)}))}}},{canProcess:{value:function(e){return!e||"wav"!==e&&"wav"!==e.type?"":"maybe"}},encode:{value:function(t,n){return new e(n).encode(t)}}}),e}();t.default=s},46:function(e,t,n){"use strict";e.exports=n(47)},47:function(e,t,n){"use strict";n.r(t),function(e){var n=function(){function e(e,t){for(var n in t){var a=t[n];a.configurable=!0,a.value&&(a.writable=!0)}Object.defineProperties(e,t)}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),a=(e===e.window&&e.URL&&e.Blob&&e.Worker,function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.self=n,this.self.postMessage=function(e){setTimeout((function(){a.onmessage({data:e})}),0)},setTimeout((function(){t.call(n)}),0)}return n(e,{postMessage:{value:function(e){var t=this;setTimeout((function(){t.self.onmessage({data:e})}),0)}}}),e}());t.default=a}.call(this,n(48))},49:function(e,t,n){"use strict";n.r(t);var a=n(19),r=n(20),i={};function o(){i.onmessage=function(e){switch(e.data.type){case"encode":i.encode(e.data.audioData,e.data.format).then((function(t){var n={type:"encoded",callbackId:e.data.callbackId,buffer:t};i.postMessage(n,[t])}),(function(t){var n=t.message,a={type:"error",callbackId:e.data.callbackId,message:n};i.postMessage(a)}))}},i.encode=function(t,n){return n.floatingPoint=!!n.floatingPoint,n.bitDepth=0|n.bitDepth||16,new Promise((function(a){var r=t.numberOfChannels,i=t.sampleRate,o=n.bitDepth>>3,c=t.length*r*o,s=new e(44+c);s.writeString("RIFF"),s.writeUint32(s.length-8),s.writeString("WAVE"),s.writeString("fmt "),s.writeUint32(16),s.writeUint16(n.floatingPoint?3:1),s.writeUint16(r),s.writeUint32(i),s.writeUint32(i*r*o),s.writeUint16(r*o),s.writeUint16(n.bitDepth),s.writeString("data"),s.writeUint32(c);var u=t.buffers.map((function(e){return new Float32Array(e)}));s.writePCM(u,n),a(s.toArrayBuffer())}))};var e=function(){function e(t){Object(a.a)(this,e),this.buffer=new ArrayBuffer(t),this.view=new DataView(this.buffer),this.length=t,this.pos=0}return Object(r.a)(e,[{key:"writeUint8",value:function(e){this.view.setUint8(this.pos,e),this.pos+=1}},{key:"writeUint16",value:function(e){this.view.setUint16(this.pos,e,!0),this.pos+=2}},{key:"writeUint32",value:function(e){this.view.setUint32(this.pos,e,!0),this.pos+=4}},{key:"writeString",value:function(e){for(var t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t))}},{key:"writePCM8",value:function(e){e=0|Math.max(-128,Math.min(128*e,127)),this.view.setInt8(this.pos,e),this.pos+=1}},{key:"writePCM16",value:function(e){e=0|Math.max(-32768,Math.min(32768*e,32767)),this.view.setInt16(this.pos,e,!0),this.pos+=2}},{key:"writePCM24",value:function(e){e=0|Math.max(-8388608,Math.min(8388608*e,8388607)),this.view.setUint8(this.pos+0,e>>0&255),this.view.setUint8(this.pos+1,e>>8&255),this.view.setUint8(this.pos+2,e>>16&255),this.pos+=3}},{key:"writePCM32",value:function(e){e=0|Math.max(-2147483648,Math.min(2147483648*e,2147483647)),this.view.setInt32(this.pos,e,!0),this.pos+=4}},{key:"writePCM32F",value:function(e){this.view.setFloat32(this.pos,e,!0),this.pos+=4}},{key:"writePCM64F",value:function(e){this.view.setFloat64(this.pos,e,!0),this.pos+=8}},{key:"writePCM",value:function(e,t){var n=t.bitDepth,a=t.floatingPoint,r=e[0].length,i=e.length,o="writePCM".concat(n);if(a&&(o+="F"),!this[o])throw new Error("not suppoerted bit depth ".concat(n));for(var c=0;c<r;c++)for(var s=0;s<i;s++)this[o](e[s][c])}},{key:"toArrayBuffer",value:function(){return this.buffer}}]),e}();i.BufferWriter=e}o.self=o.util=i,t.default=o},57:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),o=n(13),c=n.n(o),s=(n(41),n(42),n(18)),u=n(8),l=n(1),f=n.n(l),d=n(7),p=n(2),h=(n(44),(a=n(45))&&a.__esModule?a.default:a),m=n(21),w=n.n(m);window.OfflineAudioContext=window.OfflineAudioContext||window.webkitOfflineAudioContext,window.AudioContext=window.AudioContext||window.webkitAudioContext;var g=new AudioContext,b=new w.a({context:g,cache:!1});var v=function(e,t,n){if(!e&&!t)return i("Error: First argument should be either a File, URL or AudioBuffer");var a=Object.prototype.toString.call(e);if("[object String]"!==a&&"[object File]"!==a&&"[object AudioBuffer]"!==a&&"[object Object]"!==a)return i("Error: First argument should be either a File, URL or AudioBuffer");if("number"!==typeof t||t>192e3||t<3e3)return i("Error: Second argument should be a numeric sample rate between 3000 and 192000");if("[object String]"===a||"[object File]"===a)b.load(e,{onload:function(e,t){if(e)return i(e);o(t)}});else if("[object AudioBuffer]"===a)o(e);else{if("[object Object]"!==a||!e.leftBuffer||!e.sampleRate)return i("Error: Unknown input type");var r=e.rightBuffer?2:1;o(g.createBuffer(r,e.leftBuffer.length,e.sampleRate))}function i(e){console.error(e),"function"===typeof n&&n(new Error(e))}function o(e){var a=e.numberOfChannels,r=e.length*t/e.sampleRate,i=new OfflineAudioContext(a,r,t),o=i.createBufferSource();o.buffer=e,i.oncomplete=function(e){var t=e.renderedBuffer;"function"===typeof n&&n({getAudioBuffer:function(){return t},getFile:function(e){for(var n={sampleRate:t.sampleRate,channelData:[]},a=0;a<t.numberOfChannels;a++)n.channelData[a]=t.getChannelData(a);h.encode(n).then((function(t){var n=new Blob([t],{type:"audio/wav"});e(URL.createObjectURL(n))}))}})},o.connect(i.destination),o.start(0),i.startRendering()}},y=n(27),x=n.n(y),j=n(22),O=n.n(j),k=n(31),E=n.n(k),C=n(32),S=n.n(C),M=n(33),R=n.n(M),P=n(34),U=n.n(P),I=n(29),A=n.n(I),D=n(30),B=n.n(D),F=n(28),L=n.n(F);window.MediaRecorder=window.OpusMediaRecorder;var W="https://www.deeplanguagesync.com/api/v1/getVoice",T={OggOpusEncoderWasmPath:"https://cdn.jsdelivr.net/npm/opus-media-recorder@latest/OggOpusEncoder.wasm",WebMOpusEncoderWasmPath:"https://cdn.jsdelivr.net/npm/opus-media-recorder@latest/WebMOpusEncoder.wasm"},_=[],z={audioContainer:{display:"flex",justifyContent:"center",justifySelf:"center",width:"100%",minHeight:"100px",height:"100%",overflow:"scroll",boxShadow:"1px 1px 4px -2px",background:"#1d1d1d",color:"white"},audioList:{display:"inline-flex",listStyle:"none",width:"100%",paddingLeft:0,flexDirection:"column",overflow:"scroll",marginLeft:"15px",marginRight:"15px",paddingTop:"30px"},audioItem:{fontWeight:100,fontSize:"15px",padding:"5px 15px",display:"flex",alignItems:"center"},header:{background:"linear-gradient(-30deg, #d754ad 0%, #d754ad 10%, #f96785 62%, #fe7333 100%)",width:"100%",height:"285px",display:"flow-root",alignItems:"center"},headerDesc:{color:"white",fontSize:"25px",fontWeight:300,padding:"0px 30px"},buttonContainer:{height:"150px",justifySelf:"center",alignItems:"center",width:"100%",display:"inline-grid",gridTemplateColumns:"200px calc(100% - 200px)"},button:{height:"80px",width:"140px",backgroundColor:"black",color:"white",fontSize:"17px",fontWeight:600,borderStyle:"none",borderRadius:"48px",display:"flex",alignItems:"center",justifyContent:"flex-start",marginLeft:"30px"},downloadButton:{width:"50px",color:"rgb(48 106 241 / 70%)",boxShadow:"none",borderRadius:"18px",background:"white",marginRight:"20px",display:"flex",alignItems:"center",justifyContent:"center"}},q=function(){var e=Object(r.useRef)(),t=Object(r.useRef)(),n=Object(r.useState)(),a=Object(p.a)(n,2),o=a[0],c=a[1],l=Object(r.useState)(),h=Object(p.a)(l,2),m=h[0],w=h[1],g=Object(r.useState)(),b=Object(p.a)(g,2),y=b[0],j=b[1],k=Object(r.useState)(null),C=Object(p.a)(k,2),M=(C[0],C[1]),P=Object(r.useState)(null),I=Object(p.a)(P,2),D=(I[0],I[1],Object(r.useState)([])),F=Object(p.a)(D,2),q=F[0],N=F[1],V=Object(r.useState)(null),H=Object(p.a)(V,2),J=H[0],G=H[1],$=Object(r.useState)(!1),K=Object(p.a)($,2),Q=K[0],X=K[1],Y=Object(r.useState)(!1),Z=Object(p.a)(Y,2),ee=Z[0],te=Z[1],ne=Object(r.useState)(!1),ae=Object(p.a)(ne,2),re=ae[0],ie=ae[1],oe=Object(r.useState)(),ce=Object(p.a)(oe,2),se=ce[0],ue=ce[1],le=Object(r.useState)([]),fe=Object(p.a)(le,2),de=fe[0],pe=fe[1],he=Object(r.useState)(0),me=Object(p.a)(he,2),we=me[0],ge=me[1];Object(r.useEffect)((function(){return c(new(window.AudioContext||window.webkitAudioContext)),function(){o.close()}}),[]),Object(r.useEffect)((function(){o&&w(o.createAnalyser())}),[o]),Object(r.useEffect)((function(){we>100&&(ge(0),ee.requestData(),ee.pause())}),[we]),Object(r.useEffect)((function(){var t;return y&&Q?t=setInterval((function(){M(m.getByteFrequencyData(y)),function(){e.current.getContext("2d").fillStyle="rgb(255, 255, 255,0.5)",e.current.getContext("2d").clearRect(0,0,window.innerWidth,100),e.current.getContext("2d").lineWidth=2;var t=e.current.getContext("2d").createLinearGradient(0,0,window.innerWidth,0);if(t.addColorStop("0","magenta"),t.addColorStop("0.2","blue"),t.addColorStop("0.5","green"),t.addColorStop("0.8","blue"),t.addColorStop("1.0","green"),e.current.getContext("2d").strokeStyle=t,e.current.getContext("2d").beginPath(),y)for(var n=window.innerWidth/y.length,a=0,r=0;r<y.length;r++){var i=-y[r]*(75/255);0===r?e.current.getContext("2d").moveTo(a,i+75):e.current.getContext("2d").lineTo(a,i+75),a+=n}e.current.getContext("2d").lineTo(window.innerWidth,75),e.current.getContext("2d").stroke()}();var t=0,n=0;for(var a in y){if(y[a]<=40?t++:n++,n>100){ee.resume();break}if(t>1e3&&"recording"===ee.state){ge(we+1);break}}}),5):Q||clearInterval(t),function(){clearInterval(t)}}),[y,Q,we]),Object(r.useEffect)((function(){ee&&(ee.addEventListener("dataavailable",function(){var e=Object(d.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.data.size>0)){e.next=3;break}return e.next=3,v(new File([t.data],"audio.wav"),16e3,function(){var e=Object(d.a)(f.a.mark((function e(t){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t instanceof Error||t.getFile((function(e){ue(e),G(e)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ee.addEventListener("stop",(function(){console.log("ended")})))}),[ee]),Object(r.useEffect)((function(){se&&pe([].concat(Object(u.a)(de),[se]))}),[se]),Object(r.useEffect)((function(){var e=function(){var e=Object(d.a)(f.a.mark((function e(t,n){var a,r,i,o;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).then((function(e){return e.blob()}));case 2:return a=e.sent,r=new File([a],"audio.wav"),(i=new FormData).append("audio",r),o={method:"POST",body:i,crossDomain:!0},e.next=9,fetch(W,o).then((function(e){return e.json()})).then((function(e){"success"!==e.message?e.error&&(_[n]={file:t,text:e.error,sent:!0,status:"complete",error:e.error}):_[n]={file:t,text:e.data,sent:!0,status:"complete"}})).catch((function(e){return console.log(e)}));case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t=setInterval((function(){if(N(Object(u.a)(_)),!_.some((function(e){return"processing"===e.status}))&&_.some((function(e){return"queue"===e.status})))for(var t=0;t<_.length;t++)if("queue"===_[t].status){_[t].status="processing",e(_[t].file,t);break}}),100);return function(){clearInterval(t)}}),[]),Object(r.useEffect)((function(){J&&_.push({file:J,text:"",sent:!1,status:"queue"})}),[J]),Object(r.useEffect)((function(){Q?(o.resume(),ee.start()):!Q&&ee&&("paused"===ee.state&&ee.resume(),o.suspend(),ee.stop(),re.getTracks().forEach((function(e){e.stop()})))}),[Q]);return i.a.createElement(i.a.Fragment,null,i.a.createElement("section",{style:z.header},i.a.createElement("div",{style:z.buttonContainer},i.a.createElement("button",{className:"button",style:z.button,onClick:function(e){if(e.preventDefault(),Q)X(!1);else{var t={sampleSize:16,sampleRate:56e3,channelCount:1,mimeType:"audio/wav"};navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(){var e=Object(d.a)(f.a.mark((function e(n){var a,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.getTracks()[0],e.next=3,a.applyConstraints(t);case 3:ie(n),te(new MediaRecorder(n,t,T)),X(!0),o.createMediaStreamSource(n).connect(m),m.fftSize=2048,r=m.frequencyBinCount,j(new Uint8Array(r));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}}},Q?i.a.createElement(O.a,{className:"animate-flicker",style:{marginLeft:"20px",marginRight:"10px",color:"red",fontSize:"35px"}}):i.a.createElement(x.a,{style:{marginLeft:"20px",marginRight:"10px",color:"#42ec42",fontSize:"35px"}}),Q?"Stop":"Start"),i.a.createElement("div",{style:z.headerDesc},i.a.createElement("p",null,"Press start to activate text to speech recognition using deepspeech . This tool will recognize pauses in speech and trimm audio accordingly, give it a try!"))),i.a.createElement("canvas",{ref:e,width:window.innerWidth,height:"100"}),i.a.createElement("div",Object(s.a)({style:z.audioItem},"style",{height:"35px",marginLeft:"30px"}),"inactive"===ee.state&&i.a.createElement("span",{style:{display:"flex"}},i.a.createElement(L.a,{style:{marginRight:"5px"}})," Stopped"),"recording"===ee.state&&i.a.createElement("span",{style:{display:"flex"}},i.a.createElement(A.a,{style:{marginRight:"5px"}})," Okay I'm Listening"),"paused"===ee.state&&i.a.createElement("span",{style:{display:"flex"}},i.a.createElement(B.a,{style:{marginRight:"5px"}})," Hmmm please speak up!"))),i.a.createElement("div",{style:z.audioContainer},i.a.createElement("ul",{ref:t,style:z.audioList},q&&q.map((function(e,t){return i.a.createElement("li",{key:t,style:z.audioItem},i.a.createElement("a",{className:"downloadButton",href:e.file,download:"audio".concat(t+1,".wav"),style:z.downloadButton}," ",i.a.createElement(E.a,{style:{width:"50px"}})),i.a.createElement("div",{style:{display:"flex",width:"20px"}},i.a.createElement("span",{style:{width:"50px"}},t+1)),i.a.createElement("div",{style:{display:"flex",width:"50px"}},"queue"===e.status&&i.a.createElement(S.a,{className:"animate-flicker",style:{color:"blueviolet",marginLeft:"5px"}}),"processing"===e.status&&i.a.createElement(R.a,{className:"animate-flicker",style:{color:"#00feff",marginLeft:"5px"}}),"complete"===e.status&&i.a.createElement(U.a,{style:{color:"limegreen",marginLeft:"5px"}})),i.a.createElement("span",{style:{color:e.error?"#ff6d15":"unset",fontWeight:e.error?500:600,textAlign:"left",maxWidth:"70vw"}},e.text))})).reverse())))};var N={fullScreen:{height:"100vh",alignContent:"center",display:"grid",gridTemplateRows:"285px calc(100vh - 285px)"}},V=function(){return i.a.createElement("div",{className:"App",style:N.fullScreen},i.a.createElement(q,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(V,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[36,1,2]]]);
//# sourceMappingURL=main.d940fb91.chunk.js.map